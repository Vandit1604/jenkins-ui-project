<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jenkins</title>
    <link rel="canonical" href="https://docs.jenkins.com/projects/2.2/gsoc/2021/projects/git-credentials-binding.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../_'</script>
  </head>
  <body class="article">
<script type="module" src="https://unpkg.com/@jenkinsci/jenkins-io-components?module"></script>
<jio-navbar style="  position: fixed;
  top: 0;
  width: 100vw;
  z-index: 100;"></jio-navbar>
  <div class="body">
<div class="nav-container" data-component="projects" data-version="2.2">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">Jenkins Projects</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html">index.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../blueocean/index.html">index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../blueocean/about.html">about.adoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../blueocean/contribute.html">contribute.adoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../blueocean/roadmap.html">roadmap.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../jam/index.html">index.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../remoting/index.html">index.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../2018/index.html">2018/index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../2018/code-coverage-api-plugin.html">2018/code-coverage-api-plugin.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../2018/eda-plugins.html">2018/eda-plugins.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../2018/index.html">2018/index.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../2018/remoting-over-message-bus.html">2018/remoting-over-message-bus.adoc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../2018/simple-pull-request-job-plugin.html">2018/simple-pull-request-job-plugin.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../advocacy-and-outreach/index.html">index.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../jcasc/index.html">index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../jcasc/dev-tools.html">dev-tools.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../infrastructure/index.html">index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../infrastructure/ircbot.html">ircbot.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../jenkins-operator/index.html">index.adoc</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Other Projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../other/document-jenkins-on-kubernetes.html">document-jenkins-on-kubernetes.adoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../other/jenkins-x.html">jenkins-x.adoc</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jenkins Projects</span>
    <span class="version">2.2</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../images/index.html">All of Jenkins Images</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../images/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../dev-docs/index.html">Jenkins Developer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../dev-docs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../events/index.html">Jenkins Events</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../events/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">Jenkins Projects</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">2.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../security/index.html">Jenkins Security Advisories</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../security/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../solutions/2.2/index.html">Jenkins Solutions Page</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../solutions/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../../../../solutions/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../sigs/index.html">Jenkins Special Intrest Groups</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../sigs/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../tutorial/2.2/index.html">Jenkins Tutorials</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../tutorial/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../../../../tutorial/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../user-docs/2.2/index.html">Jenkins User Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../user-docs/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../../../../user-docs/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../user-docs/2.2/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/Vandit1604/jenkins-docs/edit/main/docs/projects/modules/gsoc/pages/2021/projects/git-credentials-binding.adoc"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>  Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<hr>
<div class="paragraph">
<p>layout: gsocproject
title: "Git credentials binding for sh, bat, and powershell"
goal: "Allow greater git flexibility from Jenkins Pipelines"
category: Plugins
year: 2021
sig: platform
tags:
- gsoc2021
- git
- credentials
status: "Completed"
student: arpoch
mentors:
- "markewaite"
- "rishabhbudhouliya"
- "justinharringa"
links:
  gitter: "jenkinsci_git-plugin:gitter.im"
  draft: <a href="https://docs.google.com/document/d/1dHFEHbVPNyGRGtMF30df4O0UXoqgmEJpVVNoxxXYT1w/edit?usp=sharing" class="bare">https://docs.google.com/document/d/1dHFEHbVPNyGRGtMF30df4O0UXoqgmEJpVVNoxxXYT1w/edit?usp=sharing</a>
  idea: /projects/gsoc/2021/project-ideas/git-credentials-binding-for-pipeline
  meetings: "/projects/gsoc/2021/projects/git-credentials-binding/#office-hours"
---</p>
</div>
<div class="sect2">
<h3 id="_abstract"><a class="anchor" href="#_abstract"></a>Abstract</h3>
<div class="paragraph">
<p>Allow Jenkins Pipeline users to run authenticated git commands in sh, bat, and powershell.</p>
</div>
<div class="paragraph">
<p>This project idea proposes to implement two new credential bindings that contribute files and environment variables to sh, bat, and powershell steps so that they can use command line git to perform authenticated operations.
The Jira issue requesting support for authenticated git operations (JENKINS-28335) is one of the top five most highly voted Jenkins enhancement requests.</p>
</div>
<div class="paragraph">
<p>The two credential bindings will be <code>gitSshPrivateKey</code> and <code>gitUsernamePassword</code>.
They will be implemented in the git plugin with automated tests to confirm the bindings are behaving as expected on the wide range of command line git versions and operating systems supported by the git plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rationale"><a class="anchor" href="#_rationale"></a>Rationale</h3>
<div class="paragraph">
<p>The Jenkins git plugin uses Jenkins credentials to fetch a repository and checkout a branch for freestyle, pipeline, and multibranch pipeline jobs.
It is also able to use Jenkins credentials to push tags and commits back to the repository from a freestyle job.
It supports a wide range of command line git versions, from git 1.8.3 (CentOS 7) through the current release of command line git (2.30.0, Debian testing, Windows, &#8230;&#8203;).
It supports ssh private keys with and without passphrases for ssh protocol authentication and supports usernames and passwords or API tokens for https protocol authentication.</p>
</div>
<div class="paragraph">
<p>The git plugin is not able to push tags or commits from a pipeline job or a multibranch pipeline job.
It is not able to perform other git operations that require authentication like remote branch creation or deletion.
The git plugin also does not provide authenticated access to all the command line options offered with the most recent versions of command line git.
For example, there is no support in the git plugin for the <code>--single-branch</code> option or for the <code>--recurse-submodules</code> option.</p>
</div>
<div class="paragraph">
<p>With the git credentials binding, Pipeline users will be able to push merge results, commits, and tags from a Pipeline job.
They will be able to create and delete remote branches.
They will be able to use the git command line options of their choice, including <code>--single-branch</code> and <code>--recurse-submodules</code>.
Users will be able to run authenticated git commands in their Jenkins Pipelines without modifying the git plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="_implementation"><a class="anchor" href="#_implementation"></a>Implementation</h3>
<div class="paragraph">
<p>Both <code>gitUsernamePassword</code> and <code>gitSshPrivateKey</code> bindings depend on the <a href="https://plugins.jenkins.io/credentials/">Credential Plugin</a>
to retrieve user&#8217;s credential using the Credentials API.</p>
</div>
<div class="paragraph">
<p>The <a href="https://plugins.jenkins.io/credentials-binding/">Credentials Binding Plugin</a> is used
to bind Git specific environment variables with script(sh,bat,powershell) / terminal commands depending upon the current CLI-git version installed on
system which is being used to perform git operation that requires authentication.</p>
</div>
<div class="paragraph">
<p>The bindings only provide authentication support for the command line git implementation.
Other Git implementations inside the git client plugin such as <code>JGit</code> and <code>JGit with Apache HTTP Client</code> are not supported.
Users are provided with a dropbox which lists all the Git-Tool implementation of
CLI-Git configured in Jenkins <code>Global System Configuration</code>.</p>
</div>
<div class="paragraph">
<p>Both the bindings works on behalf of the user to provide git authentication support, without complicated steps to pass the credentials to command line git.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>If no CLI-Git implemented Git-Tool is available in <code>Global System Configuration</code> then by default JGit
implemented Git-Tool will be used.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="_git_username_and_password_binding"><a class="anchor" href="#_git_username_and_password_binding"></a>Git Username and Password Binding</h4>
<div class="paragraph">
<p>The <code>gitUsernamePassword</code> implementation uses the Jenkins username and password
values retrieved through Credential API, to access a remote repository  over <strong>HTTP</strong> protocol.
The binding uses the <code>GIT_ASKPASS</code> environment variable to provide credentials requested by a git operation in a pipeline job/freestyle project.
Executable script(sh,bat,powershell) is attached/bound to the <code>GIT_ASKPASS</code> variable, which is invoked when asked for the user’s credentials by HTTP server.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pipeline Job</dt>
<dd>
<p>Using Git Username and Password Binding in a Pipeline Job</p>
</dd>
</dl>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/usernamepassword-binding-pipeline-job.png" alt="Git Username and Password in Pipeline Job">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FreeStyle Project</dt>
<dd>
<p>Using Git Username and Password Binding in a FreeStyle-Project</p>
</dd>
</dl>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/usernamepassword-binding-freestyle-project.png" alt="Git Username and Password in FreeStyle Project">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Two variable bindings <code>GIT_USERNAME</code> and <code>GIT_PASSWORD</code> provide the username and password respectively.
These variable bindings are also accessible when using <code>JGit/JGit with Apache HTTP Client</code> Git-Tool
implementations in both freestyle project and pipeline job.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_git_ssh_private_key_binding"><a class="anchor" href="#_git_ssh_private_key_binding"></a>Git SSH Private Key Binding</h4>
<div class="paragraph">
<p>The <code>gitSshPrivateKey</code> implementation provides git authentication support over <strong>SSH</strong> protocol
using private key and passphrase credentials of a user. The binding uses two git specific environment
variables depending upon the minimum CLI-git version</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GIT_SSH_COMMAND</code> - If version is greater than or equal to 2.3, then the GIT_SSH_COMMAND environment variable provides the ssh command including
necessary options which are: path to the private key and host key checking, to authenticate and connect to the git server without using an executable script.</p>
</li>
<li>
<p><code>SSH_ASKPASS</code> - If version is less than 2.3, an executable script is attached to the variable which provides the
ssh command including necessary options which are: path to the private key and host key checking, to authenticate and connect to the git server</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Support for private key formats</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The following key formats are supported through Jenkins plugins</p>
<div class="ulist">
<ul>
<li>
<p><code>BouncyCastle API Plugin</code> - Supports decryption of PKCS#8 PEM encoded and PEM private keys.</p>
</li>
<li>
<p><code>SSHD Plugin</code> - Provides a transitive dependency i.e. Apache SSHD-Core v2.7.0, which supports decryption of
OpenSSH/RFC4716 formatted private keys.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Support for encryption algorithms</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The following encryption algorithms are supported in various formats discussed above</p>
<div class="ulist">
<ul>
<li>
<p>RSA</p>
</li>
<li>
<p>DSA</p>
</li>
<li>
<p>ECDSA</p>
</li>
<li>
<p>ED25519</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_decryption_of_private_keys"><a class="anchor" href="#_decryption_of_private_keys"></a>Decryption of private keys</h5>
<div class="paragraph">
<p>The passphrase protected private key needs to be decrypted before it can be used to perform the
git authentication operation over <strong>SSH</strong> protocol, if not decrypted then a prompt is displayed to
the user asking for the passphrase of the private key being used in the current job/project, which is not an expected behaviour since
the passphrase is already provided by the user through Jenkins <a href="https://plugins.jenkins.io/credentials/">Credential Plugin</a>.</p>
</div>
<div class="paragraph">
<p>To tackle this issue, the BouncyCastle API plugin and SSHD plugin are used to provide decryption support
for the various private formats mentioned above.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Pipeline Job</dt>
<dd>
<p>Using Git SSH Private Key in a Pipeline Job</p>
</dd>
</dl>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/ssh-private-key-pipeline-job.png" alt="Git SSH Private Key in Pipeline Job">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">FreeStyle Project</dt>
<dd>
<p>Using Git SSH Private Key Binding in a FreeStyle-Project</p>
</dd>
</dl>
</div>
<div class="imageblock unresolved">
<div class="content">
<img src="/images/gsoc/2021/git-credentials/ssh-private-key-freestyle-job.png" alt="Git SSH Private Key in FreeStyle Project">
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>Unlike GitUsernamePassword binding, no variable bindings are supported by gitSshPrivateKey binding.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_office_hours"><a class="anchor" href="#_office_hours"></a>Office hours</h3>
<div class="paragraph">
<p>The Office hours are scheduled twice a week each Wednesday and Friday at 2:00 UTC, with regular <a href="https://docs.google.com/document/d/1gZneYIDWrT5S-1ACG641wfvxs7vnDC0RCYqy-EuuhwY/edit?usp=sharing">meeting notes</a> available for anyone to read.</p>
</div>
</div>
<div class="sect2">
<h3 id="_links"><a class="anchor" href="#_links"></a>Links</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://groups.google.com/g/jenkinsci-gsoc-all-public/c/VdUhhM1Noxc/m/Zk4yajsFAwAJ">Jenkins GSoC mailing list discussion of git credentials pipeline task</a></p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-28335">JENKINS-28335</a> - Pipeline step to run Git commands with credentials &amp; tool</p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-47733">JENKINS-47733</a> - Add a <code>withGit</code> pipeline step that provides git credentials</p>
</li>
<li>
<p><a href="https://issues.jenkins.io/browse/JENKINS-36496">JENKINS-36496</a> - Support git publisher with Pipeline</p>
</li>
</ul>
</div>
</div>
</article>
  </div>
</main>
</div>
<jio-footer></jio-footer>
<script id="site-script" src="../../../../../_/js/site.js" data-ui-root-path="../../../../../_"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
