<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Securely implementing form validation :: Jenkins</title>
    <link rel="canonical" href="https://docs.jenkins.com/dev-docs/security/form-validation.html">
    <link rel="prev" href="secrets.html">
    <link rel="next" href="xss-prevention.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<script type="module" src="https://unpkg.com/@jenkinsci/jenkins-io-components?module"></script>
<jio-navbar style="  position: fixed;
  top: 0;
  width: 100vw;
  z-index: 100;"></jio-navbar><div class="body">
<div class="nav-container" data-component="dev-docs" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Jenkins Developer Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../handling-requests/index.html">Handling Requests</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../handling-requests/routing.html">Routing Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../handling-requests/actions.html">Web Methods</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../handling-requests/responses.html">Responding to Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../handling-requests/json.html">Expose HTTP API with JSON content with Jenkins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../handling-requests/deprecated-reflective-access.html">Deprecated reflective access</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../crowdin/index.html">Jenkins Crowdin Integration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../crowdin/crowdin-integration.html">Setup a Crowdin Project</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../crowdin/translating-plugins.html">Translating plugins through Crowdin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../crowdin/proofread-content.html">How to proofread translation suggestions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../crowdin/troubleshooting.html">Troubleshooting crowdin issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../persistence/index.html">Persistent Objects</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../persistence/backward-compatibility.html">Backward Compatibility with XStream</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../persistence/custom-converter.html">Registering a Custom Converter</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../persistence/incompatible-releases.html">Marking Incompatible Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../architecture/index.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../architecture/model.html">Model</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../architecture/web.html">Stapler Web Framework</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../architecture/extensions.html">Extensions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../architecture/remoting.html">Remoting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../internationalization/index.html">Internationalization and Localization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/i18n-source-code.html">Internationalizing Messages in Java Source Code</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/i18n-jelly-views.html">Internationalizing Messages in Jelly Views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/i18n-groovy-views.html">Internationalizing Messages in Groovy Views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/advanced-localization.html">Advanced Localization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/prepare-a-java-source-file.html">Prepare a Java Source File for Localization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/prepare-a-jelly-view.html">Prepare a Jelly-based View for Localization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/prepare-a-groovy-view.html">Preparing a Groovy-based View for Localization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/translate-a-help-file.html">Translate a help file</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../internationalization/translate-a-properties-file.html">Translate a properties file</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../development-enviorment/index.html">Development Environment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development-enviorment/ide-configuration.html">IDE Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development-enviorment/taglibs.html">Taglibs</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../extensibility/index.html">Extensibility</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../extensibility/action-for-all-projects.html">How to show a menu item on all projects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../extensibility/serialization-of-anonymous-classes.html">How to serialize anonymous classes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugin-tutorial/index.html">Plugin Tutorial</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-tutorial/prepare.html">Preparing for Plugin Development</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-tutorial/create.html">Create a Plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-tutorial/run.html">Build and Run the Plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-tutorial/extend.html">Extend the Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugin-development/index.html">Plugin Development</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/build-process.html">Plugin Build Process</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/choosing-jenkins-baseline.html">Choosing a Jenkins version to build against</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/dependency-management.html">Dependency Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/dependencies-and-class-loading.html">Dependencies and Class Loading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/optional-dependencies.html">Optional dependencies</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/plugin-release-tips.html">Plugin Release Tips</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/incrementals.html">Incrementals: Developing Components in Parallel</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/updating-parent.html">Updating Your Maven Parent POM</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/mark-a-plugin-incompatible.html">Mark a new plugin version as incompatible with older versions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/writing-an-scm-plugin.html">Writing an SCM Plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-development/pipeline-integration.html">Writing Pipeline-Compatible Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugin-governance/index.html">Plugin Governance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-governance/managing-permissions.html">Managing plugin permissions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-governance/adopt-a-plugin.html">Adopt a Plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-governance/deprecating-or-removing-plugin.html">Deprecating or removing a Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../publishing/index.html">Publishing Plugins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/style-guides.html">Style Guides</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/source-code-hosting.html">Source Code Hosting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/artifact-repository.html">Artifact Repository</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/documentation.html">Plugin Documentation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/wiki-page.html">Plugin Wiki Pages</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/plugin-site.html">Plugin Site</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/continuous-integration.html">Continuous Integration - buildPlugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/usage-statistics.html">Usage Statistics</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/preparation.html">Before you start</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/new-plugin.html">Creating a new plugin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/requesting-hosting.html">Guide to Plugin Hosting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/releasing.html">Performing a Plugin Release</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/releasing-cd.html">Setting up automated plugin release</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/releasing-manually.html">Performing a Plugin Release manually</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/removing-from-distribution.html">Removing plugins from distribution</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../publishing/releasing-experimental-updates.html">Publishing Experimental Plugin Releases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../building/index.html">Building and Debugging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../building/intellij.html">IntelliJ Setup for Jenkins Core Development</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../tutorial-improve/index.html">Improve a Plugin Tutorial</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/add-a-jenkinsfile.html">Add a Jenkinsfile</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/update-parent-pom.html">Update parent POM</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/update-base-jenkins-version.html">Update Jenkins version</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/update-scm-url.html">Update SCM URL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/add-more-spotbugs-checks.html">Add more spotbugs checks</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/automate-dependency-update-checks.html">Check dependencies</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/use-plugin-bill-of-materials.html">Use plugin bill of materials</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/enable-incrementals.html">Enable incrementals</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/migrate-documentation-to-github.html">Migrate documentation to GitHub</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/add-a-contributing-guide.html">Add a contributing guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/add-a-link-to-report-an-issue.html">Report an Issue</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/replace-jsr-305-annotations.html">Replace JSR-305</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/convert-translations.html">Convert translations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorial-improve/move-description-to-index.html">Move description</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../views/index.html">Views</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/read-only.html">Read only view</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/table-to-div-migration.html">Table to div layout migration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/exposing-bundled-resources.html">Exposing bundled resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/icon-path-to-icon-class-migration.html">Icon path to icon class migration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../views/symbols.html">Symbols</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="secrets.html">Storing Secrets</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="form-validation.html">Securely implementing form validation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="xss-prevention.html">Preventing Cross-Site Scripting in Jelly views</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rendering-user-content.html">Rendering User Content</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="remoting-callables.html">Remoting Callables</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="read-access.html">Restricting HTTP Access to &lt;code&gt;AccessControlled&lt;/code&gt; Objects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="csp.html">Content-Security-Policy Compatibility</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="misc.html">Miscellaneous API Usage Recommendations</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../cli/index.html">Jenkins CLI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cli/writing-cli-commands.html">Writing CLI commands</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../initialization/index.html">Initialization and Startup ⚠️</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../initialization/embedded-container.html">Embedded Winstone and <code>executable-war</code></a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../template/index.html">index.adoc</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text">xref:</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../forms/index.html">Forms</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../forms/form-validation.html">Form validation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../forms/adding-tool-tips.html">Adding tool tips</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../forms/jelly-form-controls.html">Jelly form controls</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../forms/structured-form-submission.html">Structured form submission</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jenkins Developer Documentation</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Jenkins Developer Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solutions/2.2/index.html">Jenkins Solutions Page</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solutions/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../solutions/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../tutorial/2.2/index.html">Jenkins Tutorials</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../tutorial/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../tutorial/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../user-docs/2.2/index.html">Jenkins User Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../user-docs/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../user-docs/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../user-docs/2.2/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Jenkins Developer Documentation</a></li>
    <li><a href="index.html">Security</a></li>
    <li><a href="form-validation.html">Securely implementing form validation</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/Vandit1604/jenkins-docs/edit/main/docs/dev-docs/modules/security/pages/form-validation.adoc"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>  Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Securely implementing form validation</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide looks at form validation from a security point of view:
What are the considerations for securing form validation, and how can they be best implemented?</p>
</div>
<div class="paragraph">
<p>First, let&#8217;s look at a typical form field defined in Jelly, and its validation method in the object&#8217;s descriptor.
This forms the basis for the rest of this guide.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;f:entry field="foo"&gt;
  &lt;f:textbox /&gt;
&lt;/f:entry&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public FormValidation doCheckFoo(@QueryParameter String value) {
  if (Util.fixEmptyAndTrim(value) == null) {
    return FormValidation.error("foo cannot be empty");
  }
  return FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Stapler routing and Jenkins behavior will result in this method being routed at a URL like <code>/descriptorByName/f.q.ClassName/checkFoo</code>.
This URL will contain a minimal HTML snippet with a form validation message (if present) based on the presence and value of the <code>value</code> query parameter.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_potential_security_issues"><a class="anchor" href="#_potential_security_issues"></a>Potential Security Issues</h3>
<div class="sect3">
<h4 id="_returning_private_information"><a class="anchor" href="#_returning_private_information"></a>Returning Private Information</h4>
<div class="paragraph">
<p>By default, any user with Overall/Read access can access form validation methods like the example method above.
Some form validation methods could be used to infer private information, and as such may need to be protected from unauthorized access.</p>
</div>
<div class="paragraph">
<p>If a form validation method is supposed to only be accessible to users with specific permissions, a permission check should be added.</p>
</div>
</div>
<div class="sect3">
<h4 id="_side_effects"><a class="anchor" href="#_side_effects"></a>Side Effects</h4>
<div class="paragraph">
<p>Form validation can become quite complex and have side effects.
For example, Jenkins might evaluate a Groovy script passed as parameter, or access a URL passed as parameter.
These behaviors could be exploited to result in arbitrary code execution and server-side request forgery, respectively.</p>
</div>
<div class="paragraph">
<p>Ensuring that form validation code such as this is protected with appropriate permission checks, it might not be enough:
<a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> is an attack on users with the necessary privileges and exploits the trust Jenkins has in these legitimate users' web browsers.
Protecting from these attacks requires that form validation methods with side effects only accept <code>POST</code> requests.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_implementing_form_validation"><a class="anchor" href="#_implementing_form_validation"></a>Implementing Form Validation</h3>
<div class="sect3">
<h4 id="_checking_permissions"><a class="anchor" href="#_checking_permissions"></a>Checking permissions</h4>
<div class="paragraph">
<p>To check for global permissions like <code>Administer</code>, add a call to <code>Jenkins#checkPermission</code>. Note that Overall/Read permission is always implied (unless you specifically implement jenkinsdoc:UnprotectedRootAction[]).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public FormValidation doCheckFoo(@QueryParameter String value) {
  Jenkins.get().checkPermission(Jenkins.ADMINISTER); // or Jenkins.getInstance() on older core baselines
  if (Util.fixEmptyAndTrim(value) == null) {
    return FormValidation.error("foo cannot be empty");
  }
  return FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a different jenkinsdoc:AccessControlled[]'s permissions are to be checked, as the form validation depends on the context in which the method is invoked (e.g. when writing a build step and validation depends on the identity of the item), you may need to add an jenkinsdoc:AncestorInPath[<code>@AncestorInPath</code>] annotated parameter to get to the necessary context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public FormValidation doCheckFoo(@QueryParameter String value, @AncestorInPath Item item) {
  if (item == null) { // no context
    return FormValidation.ok();
  }
  item.checkPermission(Item.CONFIGURE);

  if (Util.fixEmptyAndTrim(value) == null) {
    return FormValidation.error("foo cannot be empty");
  }
  return FormValidation.ok();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_protecting_from_csrf"><a class="anchor" href="#_protecting_from_csrf"></a>Protecting from CSRF</h4>
<div class="paragraph">
<p>Stapler web methods, like form validation, can be invoked using any HTTP verb by default.
This can be used by malicious users to attack an application by way of its legitimate users:
Cross-site request forgery is the result of a web application (Jenkins) trusting legitimate users' browser.</p>
</div>
<div class="paragraph">
<p>To prevent this, Jenkins includes CSRF protection that requires actions with side effects (POST requests) to submit a user-specific secret, called a <em>crumb</em>.
To ensure this protection is relevant, web methods with side effects need to reject requests not sent via POST.
There are two options to achieve this in general:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>staplerdoc:org.kohsuke.stapler.verb.POST[<code>POST</code>] limits processing to just the POST verb, and all other verbs will receive a 404 response. This is recommended approach for form validation methods.</p>
</li>
<li>
<p>staplerdoc:org.kohsuke.stapler.interceptor.RequirePOST[<code>RequirePOST</code>] is the older (and more common) approach. It will show a form allowing users to resubmit the request using POST if they used a different verb. This is mostly useful for simple API actions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Applying this protection is as simple as adding the annotation to the method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@POST
public FormValidation doCheckFoo(@QueryParameter String value) {
  if (Util.fixEmptyAndTrim(value) == null) {
    return FormValidation.error("foo cannot be empty");
  }
  return FormValidation.ok();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the versions of Jenkins supported by your plugin, these form validation methods may be invoked using HTTP GET, however, so the form may need to be adapted as well.
The Jenkins form Jelly controls support the <code>checkMethod</code> attribute, which, if set to <code>post</code>, will result in form validation being invoked via HTTP POST.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;f:entry field="foo"&gt;
  &lt;f:textbox checkMethod="post" /&gt;
&lt;/f:entry&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default behavior of form controls has changed over time, so you may not need to add the <code>checkMethod</code> attribute depending on the versions of Jenkins supported by your plugin and the types of form controls that have validation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Historically, form validation requests were sent using GET by default (with the exception of <code>f:validateButton</code>, which always used POST).</p>
</li>
<li>
<p>Since Jenkins 2.84 and 2.73.3, <code>f:password</code> always sends form validation as <code>POST</code>.</p>
</li>
<li>
<p>Since Jenkins 2.285, most other form controls send form validation requests as <code>POST</code> by default, and <code>checkMethod</code> would only opt out.</p>
</li>
<li>
<p>As of Jenkins 2.300 <code>f:checkbox</code> does not support the <code>checkMethod</code> attribute at all and requests are always sent using GET.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some basic form controls may not declare the <code>checkMethod</code> attribute in older versions of Jenkins. Depending on the control it could still work, despite an error shown in your IDE.
</td>
</tr>
</table>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="secrets.html">Storing Secrets</a></span>
  <span class="next"><a href="xss-prevention.html">Preventing Cross-Site Scripting in Jelly views</a></span>
</nav>
</article>
  </div>
</main>
</div>
<jio-footer></jio-footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
